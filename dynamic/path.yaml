http:
  routers:
    user-api:
      rule: "Host(`localhost`) && PathPrefix(`/users`)"
      entryPoints: [web]
      service: user-service
      # todo middleware

    device-api:
      rule: "Host(`localhost`) && PathPrefix(`/devices`)"
      entryPoints: [web]
      service: device-service
      # todo middleware
    
    auth-api:
      rule: "Host(`localhost`) && PathPrefix(`/auth`)"
      entryPoints: [web]
      service: auth-service

  middlewares:
    jwt-auth:
      plugin:
        jwt-validation-middleware:
          # SECRET - match with auth service
          secret: "supersecret123456supersecret123456" 
          signingMethod: "HS256"
          authHeader: true
          claims: "role"
          requiredClaim:
            role: ["ROLE_USER", "ROLE_ADMIN"]
          payloadHeaders:
            X-User: "sub"
            X-Role: "role"

  services:
    user-service:
      loadBalancer:
        servers:
          - url: "http://user-service:8080"    # container name + internal port
    device-service:
      loadBalancer:
        servers:
          - url: "http://device-service:8080" 
    auth-service:
      loadBalancer:
        servers:
          - url: "http://auth-service:8081"
